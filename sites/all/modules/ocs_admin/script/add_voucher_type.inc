<?php

$usage = array(
'10' => 'C',
'11' => 'C',
'13' => 'C',
'14' => 'C',
'15' => 'C',
'18' => 'C',
'20' => 'C',
'21' => 'C',
'24' => 'C',
'25' => 'C',
'26' => 'C',
'26' => 'C',
'28' => 'C',
'30' => 'C',
'31' => 'C',
'32' => 'C',
'33' => 'C',
'34' => 'C',
'35' => 'C',
'36' => 'C',
'37' => 'C',
'38' => 'C',
'38' => 'C',
'39' => 'C',
'39' => 'C',
'40' => 'C',
'40' => 'C',
'40' => 'C',
'41' => 'C',
'41' => 'C',
'42' => 'C',
'42' => 'C',
'44' => 'C',
'45' => 'E',
'45' => 'C',
'46' => 'C',
'47' => 'C',
'48' => 'C',
'49' => 'C',
'51' => 'C',
'52' => 'C',
'53' => 'C',
'54' => 'C',
'55' => 'C',
'56' => 'C',
'57' => 'C',
'58' => 'C',
'59' => 'C',
'60' => 'C',
'61' => 'C',
'62' => 'C',
'63' => 'C',
'64' => 'C',
'65' => 'C',
'66' => 'C',
'67' => 'C',
'68' => 'C',
'69' => 'C',
'70' => 'C',
'71' => 'C',
'72' => 'C',
'73' => 'C',
'74' => 'C',
'75' => 'C',
'77' => 'C',
'78' => 'C',
'79' => 'C',
'80' => 'R',
'81' => 'E',
'82' => 'E',
'83' => 'C',
'84' => 'C',
'85' => 'C',
'86' => 'E',
'87' => 'C',
'88' => 'C',
'89' => 'C',
'90' => 'C',
'91' => 'E',
'92' => 'E',
'93' => 'C',
'94' => 'C',
'95' => 'C',
'96' => 'C',
'97' => 'C',
'98' => 'C',
'99' => 'C',
'100' => 'C',
'101' => 'C',
'102' => 'C',
'103' => 'E',
'104' => 'C',
'105' => 'C',
'106' => 'C',
'106' => 'C',
'107' => 'C',
'107' => 'C',
'108' => 'C',
'108' => 'E',
'109' => 'C',
'109' => 'C',
'110' => 'C',
'110' => 'C',
'111' => 'C',
'111' => 'C',
'112' => 'C',
'113' => 'C',
'113' => 'C',
'114' => 'C',
'114' => 'C',
'114' => 'C',
'115' => 'C',
'115' => 'C',
'116' => 'C',
'116' => 'C',
'117' => 'C',
'117' => 'C',
'118' => 'C',
'118' => 'C',
'119' => 'C',
'119' => 'C',
'120' => 'C',
'120' => 'C',
'121' => 'C',
'121' => 'C',
'122' => 'E',
'122' => 'C',
'122' => 'C',
'123' => 'R',
'123' => 'C',
'123' => 'C',
'124' => 'C',
'124' => 'C',
'125' => 'C',
'125' => 'C',
'125' => 'C',
'126' => 'C',
'127' => 'C',
'128' => 'C',
'129' => 'C',
'129' => 'C',
'130' => 'C',
'130' => 'E',
'131' => 'C',
'131' => 'E',
'132' => 'C',
'132' => 'C',
'132' => 'C',
'133' => 'C',
'133' => 'C',
'134' => 'C',
'134' => 'C',
'135' => 'C',
'135' => 'C',
'136' => 'C',
'136' => 'C',
'137' => 'C',
'137' => 'C',
'138' => 'C',
'138' => 'C',
'139' => 'C',
'139' => 'C',
'141' => 'C',
'142' => 'C',
'142' => 'C',
'143' => 'C',
'143' => 'C',
'144' => 'C',
'144' => 'C',
'145' => 'C',
'146' => 'C',
'147' => 'C',
'148' => 'C',
'149' => 'C',
'150' => 'C',
'151' => 'C',
'152' => 'R',
'152' => 'C',
'153' => 'C',
'154' => 'C',
'155' => 'C',
'156' => 'C',
'156' => 'C',
'156' => 'C',
'157' => 'C',
'157' => 'C',
'157' => 'C',
'157' => 'C',
'158' => 'C',
'158' => 'E',
'158' => 'C',
'159' => 'C',
'160' => 'C',
'160' => 'C',
'161' => 'C',
'163' => 'C',
'163' => 'C',
'163' => 'C',
'164' => 'C',
'164' => 'C',
'165' => 'C',
'166' => 'C',
'167' => 'C',
'167' => 'C',
'168' => 'C',
'169' => 'C',
'169' => 'C',
'174' => 'C',
'175' => 'C',
'176' => 'C',
'177' => 'C',
'177' => 'C',
'178' => 'C',
'178' => 'C',
'179' => 'C',
'179' => 'C',
'180' => 'C',
'180' => 'C',
'181' => 'C',
'181' => 'C',
'181' => 'C',
'182' => 'C',
'182' => 'C',
'183' => 'C',
'183' => 'C',
'184' => 'C',
'185' => 'C',
'186' => 'C',
'187' => 'C',
'188' => 'C',
'189' => 'C',
'190' => 'C',
'191' => 'C',
'192' => 'C',
'193' => 'C',
'194' => 'C',
'194' => 'C',
'195' => 'C',
'196' => 'C',
'198' => 'C',
'199' => 'C',
'200' => 'C',
'201' => 'C',
'202' => 'C',
'203' => 'C',
'204' => 'C',
'205' => 'C',
'210' => 'C',
'211' => 'C',
'212' => 'C',
'213' => 'C',
'214' => 'C',
'215' => 'C',
'216' => 'C',
'217' => 'C',
'218' => 'C',
'219' => 'C',
'220' => 'C',
'221' => 'C',
'222' => 'C',
'223' => 'C',
'224' => 'C',
'225' => 'C',
'226' => 'C',
'227' => 'C',
	);

$case = array(
		/*
,CARDTYPE,|,ACTIVE,GRACE,PRICE,FREE_TIME,VIDEO_FREE_TIME,FREE_SMS,FREE_MMS,FREE_CRBT,FREE_GPRS,PACKET_PACKAGE,RECHARGE_CATEGORY
*/
		/*
	array('1','|','20','14','2000','0','0','0','0','0','0','0','NPSYGUHQM'),
	array('3','|','0','0','500','0','0','0','0','0','0','0','AZBXCDEFYGUHPNSQMW'),
	array('4','|','30','14','3000','0','0','0','0','0','0','0','NPSYGUHQM'),
	array('5','|','50','14','5000','0','0','0','0','0','0','0','NPSYGUHQM'),
	array('6','|','0','0','1000','0','0','0','0','0','0','0','AZBXCDEFYGUHPNSQMW'),
	array('7','|','100','14','10000','0','0','0','0','0','0','0','NPSYGUHQM'),
	array('8','|','0','0','2000','0','0','0','0','0','0','0','AZBXCDFEW'),
	array('9','|','30','14','5000','0','0','0','0','0','0','0','BCEF'),
	array('10','|','0','0','6000','0','0','0','0','0','0','0','AZBXCDFEW'),
	array('11','|','0','0','1000','0','0','0','0','0','0','0','IJK'),
	array('12','|','30','14','6000','0','0','0','0','0','0','0','YGUHNSM'),
	array('13','|','120','14','20000','0','0','0','0','0','0','0','Y'),
	array('14','|','0','0','2000','0','0','0','0','0','0','0','IJK'),
	array('15','|','0','0','3000','0','0','0','0','0','0','0','IJK'),
	array('16','|','30','14','5000','0','0','0','0','0','0','0','B'),
	array('17','|','30','14','5000','0','0','0','0','0','0','0','BCEF'),
	array('18','|','0','0','500','0','0','0','0','0','0','0','AZBXCDEFYGUHPNSQMW'),
	array('19','|','0','0','1000','0','0','0','0','0','0','0','AZBXCDEFYGUHPNSQMW'),
	array('20','|','365','14','10000','0','0','0','0','0','0','0','BCEF'),
	array('21','|','120','14','20000','0','0','0','0','0','0','0','Y'),
	array('23','|','30','14','2000','0','0','0','0','0','0','0','IJK'),
	array('25','|','30','14','10000','0','0','0','0','0','0','0','IJK'),
	array('28','|','90','14','20000','0','0','0','0','0','0','0','IJK'),
	array('29','|','0','0','6000','0','0','0','0','0','0','0','AZBXCDFE'),
	array('30','|','30','14','8000','0','0','0','0','0','0','0','Z'),
	array('34','|','30','14','10000','0','0','0','0','0','0','0','Z'),
	array('35','|','0','0','5000','0','0','0','0','0','0','0','ABCDEFGHIJKLMNOQRSTUVWXYZ'),
	array('36','|','30','365','0','0','0','0','0','0','51200','0','P'),
	array('37','|','30','14','8000','0','0','0','0','0','0','0','Z'),
	array('38','|','50','14','3000','0','0','0','0','0','0','0','NYGSUHM'),
	array('39','|','0','0','500','0','0','0','0','0','0','0','ABCEFGMNSWXYZ'),
	array('40','|','0','0','1000','0','0','0','0','0','0','0','ABCEFGMNSWXYZ'),
	array('41','|','0','0','2000','0','0','0','0','0','0','0','ABCEFGMNSWXYZ'),
	array('42','|','120','14','20000','0','0','0','0','0','0','0','N'),
	array('43','|','0','0','500','0','0','0','0','0','0','0','BCNSYGUHZAXQEFMW'),
	array('44','|','0','0','1000','0','0','0','0','0','0','0','BCNSYGUHZAXQEFMW'),
	array('45','|','180','14','70000','0','0','0','0','0','0','0','IJK'),
	array('46','|','30','14','5000','0','0','0','0','0','0','0','CF'),
	array('47','|','365','14','10000','0','0','0','0','0','0','0','CF'),
	array('49','|','120','14','6000','0','0','0','0','0','0','0','Y'),
	array('50','|','30','14','15000','0','0','0','0','0','0','0','B'),
	array('51','|','30','14','50000','0','0','0','0','0','0','0','B'),
	array('52','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('53','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('54','|','30','14','8000','0','0','0','0','0','0','0','Z'),
	array('55','|','180','14','3000','0','0','0','0','0','0','0','Y'),
	array('56','|','180','14','3000','0','0','0','0','0','0','0','NS'),
	array('57','|','180','14','3000','0','0','0','0','0','0','0','NS'),
	array('58','|','180','14','3000','0','0','0','0','0','0','0','Y'),
	array('59','|','90','14','1000','0','0','0','0','0','0','0','N'),
	array('60','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('61','|','30','14','8000','0','0','0','0','0','0','0','Z'),
	array('62','|','30','14','2000','0','0','0','0','0','0','0','C'),
	array('63','|','730','14','10000','0','0','0','0','0','0','0','NS'),
	array('64','|','1','0','0','0','0','0','0','0','0','0','NS'),
	array('65','|','1','0','0','0','0','0','0','0','0','0','Y'),
	array('66','|','1','0','0','0','0','0','0','0','0','0','B'),
	array('67','|','1','0','0','0','0','0','0','0','0','0','C'),
	array('68','|','1','0','0','0','0','0','0','0','0','0','SNP'),
	array('69','|','1','0','0','0','0','0','0','0','0','0','Z'),
	array('70','|','365','14','150000','0','0','0','0','0','0','0','IJK'),
	array('71','|','120','14','3000','0','0','0','0','0','0','0','N'),
	array('72','|','30','14','2000','0','0','0','0','0','0','0','B'),
	array('73','|','30','14','20000','0','0','0','0','3','0','0','B'),
	array('74','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('75','|','60','14','5000','0','0','0','0','0','0','0','IJK'),
	array('76','|','0','0','5000','0','0','0','0','0','0','0','IJK'),
	array('77','|','60','14','0','0','0','0','0','0','0','204800','SNPY'),
	array('78','|','180','14','0','0','0','0','0','0','0','6291456','SNP'),
	array('79','|','365','14','0','0','0','0','0','0','0','12582912','SNP'),
	array('80','|','100','14','1000','0','0','0','0','0','0','0','NS'),
*/
	array('81','|','30','14','50000','0','0','0','0','0','0','0','B'),
	array('82','|','30','14','2000','0','0','0','0','0','0','0','B'),
	array('83','|','120','14','6000','0','0','0','0','0','0','0','NS'),
	array('84','|','30','14','20000','0','0','0','0','0','0','0','NS'),
	array('85','|','120','14','20000','0','0','0','0','0','0','0','NS'),
	array('86','|','180','14','0','0','0','0','0','0','0','0','P'),
	array('87','|','30','14','20000','0','0','0','0','3','0','0','B'),
	array('88','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('89','|','120','14','20000','0','0','0','0','0','0','0','NS'),
	array('90','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('91','|','30','14','5000','0','0','0','0','0','0','0','NPS'),
	array('92','|','90','14','0','0','0','0','0','0','0','2097152','SNP'),
	array('93','|','30','14','1000','0','0','0','0','0','0','0','N'),
	array('94','|','90','14','2000','0','0','0','0','0','0','0','N'),
	array('95','|','30','14','0','0','0','0','0','0','0','3145728','SNP'),
	array('96','|','180','14','0','0','0','0','0','0','0','6291456','SNP'),
	array('97','|','365','14','0','0','0','0','0','0','0','12582912','SNP'),
	array('98','|','30','14','10000','0','0','0','0','0','0','0','Z'),
	array('99','|','30','14','8000','0','0','0','0','0','0','0','Z'),
	array('100','|','90','14','1000','0','0','0','0','0','0','0','N'),
	array('101','|','90','14','0','0','0','0','0','0','0','1048576','NPS'),
	array('102','|','90','14','0','0','0','0','0','0','0','6291456','SNP'),
	array('103','|','120','14','3000','0','0','0','0','0','0','0','N'),
	array('104','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('105','|','120','14','50000','0','0','0','0','0','0','0','NS'),
	array('106','|','30','14','1000','0','0','0','0','0','0','0','N'),
	array('107','|','90','14','3000','0','0','0','0','0','0','0','N'),
	array('108','|','90','14','1000','0','0','0','0','0','0','0','N'),
	array('109','|','90','14','0','0','0','0','0','0','0','0','NS'),
	array('110','|','90','14','1000','0','0','0','0','0','0','0','N'),
	array('111','|','30','14','2000','0','0','0','0','0','0','0','B'),
	array('112','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('113','|','30','14','10000','0','0','0','0','0','0','0','NS'),
	array('114','|','30','14','1000','0','0','0','0','0','0','0','N'),
	array('115','|','90','14','3000','0','0','0','0','0','0','0','NS'),
	array('116','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('117','|','365','14','5000','0','0','0','0','0','0','0','C'),
	array('118','|','100','14','1000','0','0','0','0','0','0','0','N'),
	array('119','|','30','14','5000','0','0','0','0','0','0','0','C'),
	array('120','|','60','14','500','0','0','0','0','0','0','0','N'),
	array('121','|','90','14','1000','0','0','0','0','0','0','0','NS'),
	array('122','|','30','14','2500','0','0','0','0','0','0','0','B'),
	array('123','|','120','14','20000','0','0','0','0','0','0','0','M'),
	array('124','|','120','14','6000','0','0','0','0','0','0','0','M'),
	array('125','|','120','14','50000','0','0','0','0','0','0','0','M'),
	array('126','|','30','14','5000','0','0','0','0','0','0','0','E'),
	array('127','|','30','14','50000','0','0','0','0','0','0','0','E'),
	array('128','|','30','14','20000','0','0','0','0','0','0','0','E'),
	array('129','|','30','14','5000','0','0','0','0','0','0','0','F'),
	array('130','|','90','14','2000','0','0','0','0','0','0','0','N'),
	array('131','|','90','14','1000','0','0','0','0','0','0','0','N'),
	array('132','|','30','14','50000','0','0','0','0','0','0','0','F'),
	array('133','|','30','14','20000','0','0','0','0','0','0','0','F'),
	array('134','|','30','14','8000','0','0','0','0','0','0','0','W'),
	array('135','|','90','14','2000','0','0','0','0','0','0','0','N'),
	array('136','|','30','14','8000','0','0','0','0','0','0','0','W'),
	array('137','|','30','14','10000','0','0','0','0','0','0','0','W'),
	array('138','|','365','14','5000','0','0','0','0','0','0','0','B'),
	array('139','|','120','14','50000','0','0','0','0','0','0','0','W'),
	array('140','|','30','14','0','0','0','0','0','0','0','0','JIK'),
	array('141','|','365','14','0','0','0','0','0','0','0','8388608','P'),
	array('142','|','120','14','20000','0','0','0','0','0','0','0','W'),
	array('143','|','30','14','5000','0','0','0','0','0','0','0','B'),
	array('144','|','120','14','6000','0','0','0','0','0','0','0','N'),
	array('145','|','90','14','4000','0','0','0','0','0','0','0','N'),
	array('146','|','180','14','5000','0','0','0','0','0','0','0','N'),
	array('147','|','365','14','5000','0','0','0','0','0','0','0','N'),
	array('148','|','30','14','2000','0','0','0','0','0','0','0','B'),
	array('149','|','180','14','5000','0','0','0','0','0','0','0','B'),
	array('150','|','365','14','5000','0','0','0','0','0','0','0','B'),
	array('151','|','30','14','20000','0','0','0','0','0','0','0','C'),
	array('152','|','30','14','20000','0','0','0','0','0','0','0','C'),
	array('153','|','30','14','50000','0','0','0','0','0','0','0','C'),
	array('154','|','180','14','5000','0','0','0','0','0','0','0','C'),
	array('155','|','365','14','5000','0','0','0','0','0','0','0','C'),
	array('156','|','30','14','5000','0','0','0','0','0','0','0','B'),
	array('157','|','90','14','0','0','0','0','0','0','0','3145728','P'),
	array('158','|','60','14','500','0','0','0','0','0','0','0','N'),
	array('159','|','90','14','4000','0','0','0','0','0','0','0','N'),
	array('160','|','30','14','1000','0','0','0','0','0','0','0','N'),
	array('161','|','180','14','5000','0','0','0','0','0','0','0','B'),
	array('162','|','360','14','5000','0','0','0','0','0','0','0','B'),
	array('163','|','180','14','5000','0','0','0','0','0','0','0','B'),
	array('164','|','360','14','5000','0','0','0','0','0','0','0','B'),
	array('165','|','1825','14','0','0','0','0','0','0','0','0','N'),
	array('167','|','20','14','2000','0','0','0','0','0','0','0','NPSYGUHM'),
	array('168','|','0','0','2000','0','0','0','0','0','0','0','AZBXCDFEW'),
	array('169','|','30','14','3000','0','0','0','0','0','0','0','NPSYGUHM'),
	array('170','|','50','14','5000','0','0','0','0','0','0','0','NPSYGUHM'),
	array('171','|','365','14','10000','0','0','0','0','0','0','0','AZBXCDFEW'),
	array('172','|','100','14','10000','0','0','0','0','0','0','0','NPSYGUHM'),
	array('173','|','30','14','5000','0','0','0','0','0','0','0','BE'),
	array('174','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('175','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('176','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('177','|','30','14','2000','0','0','0','0','0','0','0','N'),
	array('178','|','90','14','3000','0','0','0','0','0','0','0','N'),
	array('179','|','30','14','0','0','0','0','0','0','0','0','C'),
	array('180','|','30','14','5000','0','0','0','0','0','0','0','Q'),
	array('181','|','30','14','5000','0','0','0','0','0','0','0','C'),
	array('182','|','30','14','5000','0','0','0','0','0','0','0','B'),
	array('183','|','30','14','5000','0','0','0','0','0','0','0','B'),
	array('184','|','30','14','20000','0','0','0','0','0','0','0','C'),
	array('185','|','30','14','20000','0','0','0','0','0','0','0','C'),
	array('186','|','365','14','10000','0','0','0','0','0','0','0','B'),
	array('187','|','30','14','2000','0','0','0','0','0','0','0','C'),
	array('188','|','180','14','5000','0','0','0','0','0','0','0','C'),
	array('189','|','180','14','5000','0','0','0','0','0','0','0','C'),
	array('190','|','365','14','10000','0','0','0','0','0','0','0','C'),
	array('191','|','30','14','2000','0','0','0','0','0','0','0','C'),
	array('192','|','180','14','5000','0','0','0','0','0','0','0','C'),
	array('193','|','365','14','10000','0','0','0','0','0','0','0','C'),
	array('194','|','90','14','2000','0','0','0','0','0','0','0','N'),
	array('195','|','100','14','1000','0','0','0','0','0','0','0','N'),
	array('196','|','30','14','0','0','0','0','0','0','0','0','N'),
	array('197','|','365','14','10000','0','0','0','0','0','0','0','B'),
	array('198','|','30','14','5000','0','0','0','0','0','0','0','C'),
	array('199','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('200','|','30','14','15000','0','0','0','0','0','0','0','B'),
	array('201','|','30','14','20000','0','0','0','0','0','0','0','N'),
	array('202','|','365','14','5000','0','0','0','0','0','0','0','B'),
	array('203','|','365','14','5000','0','0','0','0','0','0','0','B'),
	array('204','|','30','14','20000','0','0','0','0','0','0','0','C'),
	array('205','|','30','14','20000','0','0','0','0','0','0','0','C'),
	array('210','|','30','14','5000','0','0','0','0','0','0','0','B'),
	array('211','|','30','14','8000','0','0','0','0','0','0','0','Z'),
	array('212','|','30','14','10000','0','0','0','0','0','0','0','Z'),
	array('213','|','120','14','50000','0','0','0','0','0','0','0','Z'),
	array('214','|','120','14','20000','0','0','0','0','0','0','0','Z'),
	array('215','|','120','14','20000','0','0','0','0','0','0','0','Z'),
	array('216','|','120','14','20000','0','0','0','0','0','0','0','Z'),
	array('217','|','30','14','20000','0','0','0','0','0','0','0','N'),
	array('218','|','30','14','5000','0','0','0','0','0','0','0','B'),
	array('219','|','180','14','0','0','0','0','0','0','0','31457280','SNP'),
	array('220','|','30','14','50000','0','0','0','0','0','0','0','B'),
	array('221','|','30','14','20000','0','0','0','0','0','0','0','B'),
	array('222','|','120','14','50000','0','0','0','0','0','0','0','N'),
	array('223','|','120','14','20000','0','0','0','0','0','0','0','N'),
	array('224','|','120','14','5000','0','0','0','0','0','0','0','N'),
	array('225','|','30','14','5000','0','0','0','0','0','0','0','EB'),
	array('226','|','30','14','5000','0','0','0','0','0','0','0','B'),
	array('227','|','120','14','8000','0','0','0','0','0','0','0','N'),
	);


$nl = '
';

$counters = array( 'FREE_TIME','VIDEO_FREE_TIME','FREE_SMS','FREE_MMS','FREE_CRBT','FREE_GPRS','PACKET_PACKAGE');


$vtype_term = _load_all_voucher_type_terms();
print_r( $vtype_term);

global $user;

foreach( $case as $tc) {
	$voucher_type = 'fce_voucher_' . $tc[0];
	$node = _get_node_by_title( 'vouchercardtype', $voucher_type);
	$new_node = FALSE;
	if ( empty( $node)) {
		$node = ocs_admin_get_new_node('vouchercardtype');
		print 'New Voucher Type ' . $nl;
		$node->title = $voucher_type;
		$new_node = TRUE;
	}
	else {
		print 'Existing voucher type : '. $voucher_type . $nl;
	}

	$node->field_price_amount_float['und'][0]['value'] = $tc[4];
	$node->field_active_period['und'][0]['value'] = $tc[2];
	$node->field_grace_period['und'][0]['value'] = $tc[3];
	$v_usage = $usage[$tc[0]];
	if ( $v_usage == 'C') {
		$node->field_ref_voucher_type['und'][0]['tid'] = $vtype_term['Entry'];
	}
	else if ( $v_usage == 'R') {
		$node->field_ref_voucher_type['und'][0]['tid'] = $vtype_term['Recharge'];
	}
	else if ( $v_usage == 'E') {
		$node->field_ref_voucher_type['und'][0]['tid'] = $vtype_term['Reentry'];
	}
	else {
		print 'Invalid usage type : ' . $v_usage;
		$node->field_ref_voucher_type['und'][0]['tid'] = $vtype_term['Entry'];
	}
	
	// get max voucher_id
	// youngmin 
	{
		$view = views_get_view('query_vouchercardtype_max_id');
		$view->set_display('panel_pane_1');
		$view->execute();
		$viewResult = $view->result;
		
		foreach ($viewResult as $record) {
		    $maxVoucherCardTypeId = view_get_field_value_by_label($view, 'max_vouchercardtype_id', $record) + 1;
		}
	}
	$node->field_description_long['und'][0]['value'] = 'FCE voucher ' . $maxVoucherCardTypeId;
	$node->field_voucher_id['und'][0]['value'] = $maxVoucherCardTypeId;
	
	//$node->field_description_long['und'][0]['value'] = 'FCE voucher ' . $tc[0];
	//$node->field_voucher_id['und'][0]['value'] = $tc[0];

	//$node->field_use_area['und'][0]['value'] = $tc[19];
	/*
	$d1 = new DateTime( $tc[4]);
	$d2 = new DateTime( $tc[5]);
	$node->field_validfor_product['und'][0] = array(
			'value' => $d1->format( 'Y-m-d H:i:s'),
			'value2' => $d2->format( 'Y-m-d H:i:s'),
			'timezone' => 'Asia/Ulaanbaatar',
			'timezone_db' => 'Asia/Ulaanbaatar',
			'date_type' => 'datetime'
			);
			*/
	$node->field_tree_child_voca_name['und'][0]['value'] = 'tpl_vouchercardtype';

	node_save( $node);
	print 'voucher type saved'.$nl;

	// 자동으로 voucher를 위한 counter를 생성시킨다.
	$allCounters = views_get_view_result('list_counter_for_vouchercardtype', 'panel_pane_1');
	foreach($allCounters as $counter) {

		$query = new EntityFieldQuery();
		$result = $query->entityCondition('entity_type', 'node')
			->entityCondition('bundle', 'treenodecounterforvoucher')
			->fieldCondition('field_ref_counter', 'nid', $counter->nid)
			->fieldCondition('field_ref_vouchercardtype', 'nid', $node->nid)
			->execute();

		if ( count( $result) > 0) {
			$nids = array_keys( $result['node']);
			$vc = node_load( $nids[0]);
		}
		else {
			$vc = ocs_admin_get_new_node('treenodecounterforvoucher');
			$vc->field_ref_counter['und'][0]['nid'] = $counter->nid;
			$vc->field_ref_vouchercardtype['und'][0]['nid'] = $node->nid;
		}

		$counter_info = node_load( $counter->nid);
		if ( $counter_info->field_counter_id['und'][0]['value'] == 17) {
			// remains counter
			$vc->field_amount['und'][0]['value'] = $tc[4];
		}
		
		node_save($vc);
	}

	/* set counters */
	for( $i = 5; $i < 11; $i++) {
		if ( $tc[i] != 0) {
			print 'ERROR: Counter ' . $counters[$i-5] . $nl;
		}
	}

	if ( $new_node ) {
		/* link products */
		for( $i=0; $i < strlen( $tc[12]); $i++) {
			$category = substr( $tc[12], $i, 1);
			print $nl . 'Link product for category : ' . $category . $nl;
			print 'Voucher Nid : ' . $node->nid . $nl;

			$product_link = _get_node_by_title( 'treenodeproductforvoucher', $voucher_type.':'.$category);
			if ( empty( $product_link)) {
				$product_link = ocs_admin_get_new_node( 'treenodeproductforvoucher');
				$product_link->title = $voucher_type.':'.$category;
			}
			else {
				print 'Product link exist : '. $category . $nl;
				continue;
			}

			$product_link->field_ref_vouchercardtype['und'][0]['nid'] = $node->nid;
			$product = _get_node_by_title( 'simpleproductoffering', 'Prepaid ' . $category);
			if ( empty( $product)) {
				print 'Product not found : ' . $category;
			}
			else {
				$product_link->field_ref_product['und'][0]['nid'] = $product->nid;
			}
			$product_link->field_ref_tree_tid['und'][0]['value'] = 797;

			node_save( $product_link);

			_create_treenodecounterforvoucherprd($product_link, $product->nid);
		}

		// loyaltypoint content type을 자동으로 생성해준다.
		// 
		$loyaltyPoint = new StdClass();
		$loyaltyPoint->type = 'loyaltypoint';
		$loyaltyPoint->language= 'und';
		$loyaltyPoint->uid = $user->uid;
		$loyaltyPoint->field_ref_vouchercardtype['und'][0]['nid'] = $node->nid;
		node_save($loyaltyPoint);
	}
}

// return array of nodes
function _get_node_by_title( $bundle, $type)
{
	$query = new EntityFieldQuery();
	$result = $query->entityCondition('entity_type', 'node')
		->entityCondition('bundle', $bundle)
		->propertyCondition('title', $type)
		->execute();

	if ( count( $result) > 0) {
		$nids = array_keys( $result['node']);
		$node = node_load( $nids[0]);
		return $node;
	}

	return NULL;
}

function _load_all_voucher_type_terms()
{
    /* get vocabulary name */
    $vid = taxonomy_vocabulary_machine_name_load( 'vouchertype');
    $query = new EntityFieldQuery;
    $result = $query->entityCondition('entity_type', 'taxonomy_term')
        ->propertyCondition('vid', $vid->vid)
        ->execute();

    $terms = taxonomy_term_load_multiple( array_keys( $result['taxonomy_term']));
    $list = array();
    foreach( $terms as $t) {
        $list[$t->name] = $t->tid;
    }

    return $list;
}


